name: Test and Merge

on:
  push:
    branches:
      - Development

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.12.2'

      - name: Install pnpm
        run: npm install -g pnpm

      - name: Install  dependencies
        working-directory: /
        run: pnpm install

      - name: Run all the tests
        working-directory: /
        run: pnpm test:all

      # - name: Install frontend dependencies
      #   working-directory: /apps/web
      #   run: pnpm install

      # - name: Run frontend tests
      #   working-directory: /apps/web
      #   run: pnpm test

      # - name: Merge code to main branch
      #   uses: pullreminders/merge@v2
      #   with:
      #     github-token: ${{ secrets.GITHUB_TOKEN }}
      #     method: 'squash'
      #     commit-message: 'Merged changes from development branch to main'
      #     destination-branch: 'main'
